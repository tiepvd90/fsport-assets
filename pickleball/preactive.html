<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mở Bán Đợt 2 – F-Sport Active & Fastblock</title>

<style>
    * {
  box-sizing: border-box;
}

  body {
    margin: 0;
    background: #f5f5f5;
    font-family: "Be Vietnam Pro", sans-serif;
    color: #222;
  }

  /* ============================ */
  /*        HEADER TITLE          */
  /* ============================ */
  .hero-title {
    background: linear-gradient(135deg, #0072ff, #00ff88);
    text-align: center;
    padding: 26px 12px;
    color: #fff;
    max-width: 720px;
    margin: 0 auto;
    position: relative;
    overflow: hidden;
  }

  .hero-title::after {
    content: "";
    position: absolute;
    top: 0;
    left: -120%;
    width: 60%;
    height: 100%;
    background: linear-gradient(120deg, transparent, rgba(255,255,255,0.45), transparent);
    animation: shine 5s infinite;
  }

  @keyframes shine {
    0% { left: -120%; }
    60% { left: 130%; }
    100% { left: 130%; }
  }

  .hero-title h1 {
    margin: 0;
    font-size: 20px;
    font-weight: 800;
    line-height: 1.35;
  }

  /* ============================ */
  /*       DESCRIPTION BLOCK      */
  /* ============================ */

  .hero-desc {
    max-width: 720px;
    margin: 20px auto 0;
    padding: 0 16px 20px;
    font-size: 14px;
    color: #333;
    text-align: center;
    line-height: 1.6;
  }

  .hero-desc b {
    color: #d81b60;
  }

  /* ============================ */
  /*          PRODUCT CARD        */
  /* ============================ */
  .container {
    width: 92%;
    max-width: 720px;
    margin: auto;
    padding-bottom: 60px;
  }

  .product-card {
    background: #fff;
    border-radius: 16px;
    padding: 15px;
    margin-top: 20px;
    box-shadow: 0 3px 12px rgba(0,0,0,0.08);
  }

  .product-card img {
    width: 100%;
    border-radius: 12px;
  }

  .product-card h3 {
    margin: 12px 0 6px;
    font-size: 18px;
    font-weight: 700;
  }

  .desc {
    font-size: 13px;
    color: #444;
  }

  .price-old {
    text-decoration: line-through;
    margin-top: 10px;
    font-size: 14px;
    color: #777;
  }

  .price-new {
    font-size: 20px;
    font-weight: 800;
    color: #e53935;
    margin-top: 2px;
  }

  .save {
    margin-top: 4px;
    color: #009944;
    font-size: 14px;
    font-weight: 700;
  }

  /* Progress bar */
  .progress-wrap {
    margin-top: 14px;
    background: #e0e0e0;
    height: 10px;
    border-radius: 10px;
    overflow: hidden;
  }

  .progress-fill {
    height: 10px;
    background: linear-gradient(90deg, #ff6a00, #ffcd00);
    width: 0%;
  }

  .slot-text {
    margin-top: 6px;
    font-size: 13px;
    color: #555;
    font-weight: 600;
  }

  .btn-select {
    margin-top: 15px;
    padding: 12px;
    background: #111;
    color: #fff;
    border-radius: 10px;
    text-align: center;
    font-weight: 600;
    cursor: pointer;
  }

  /* ============================ */
  /*           POPUP FORM         */
  /* ============================ */
  #formPopup, #successPopup {
    display: none;
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0,0,0,0.55);
    justify-content: center;
    align-items: center;
    padding: 18px;
    z-index: 100;
  }

  .popup-box {
    width: 95%;
    max-width: 420px;
    background: #fff;
    border-radius: 14px;
    padding: 22px;
    position: relative;
  }

  .popup-box h2 {
    margin: 0 0 14px;
    text-align: center;
    font-size: 18px;
    font-weight: 800;
  }

  label {
    margin-top: 12px;
    font-weight: 600;
    display: block;
    font-size: 13px;
  }

  input, textarea {
    width: 100%;
    padding: 11px;
    border-radius: 8px;
    border: 1px solid #ccc;
    margin-top: 6px;
    font-size: 14px;
  }

  .submit-btn {
    margin-top: 22px;
    width: 100%;
    padding: 14px;
    background: #e53935;
    border: none;
    border-radius: 10px;
    font-size: 16px;
    color: #fff;
    font-weight: 700;
    cursor: pointer;
  }

  .close-btn {
    margin-top: 12px;
    width: 100%;
    padding: 12px;
    background: #111;
    color: #fff;
    border: none;
    border-radius: 10px;
    cursor: pointer;
  }

  /* small icon nav in thankyou */
  .nav-row {
    display: flex;
    justify-content: center;
    gap: 22px;
    margin-top: 10px;
  }
  .nav-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-decoration: none;
    color: #222;
    font-size: 11px;
  }
</style>
</head>

<body>

<!-- ============================= -->
<!--       TITLE GRADIENT          -->
<!-- ============================= -->
<div class="hero-title">
  <h1>MỞ BÁN ĐỢT 2<br>F-SPORT ACTIVE & FASTBLOCK</h1>
</div>

<!-- ============================= -->
<!--       DESCRIPTION TEXT        -->
<!-- ============================= -->
<div class="hero-desc">
  Sau 10 ngày mở bán đầu tiên cháy hàng, F-Sport rất vui và cám ơn sự ủng hộ của quý khách hàng.<br><br>
  F-Sport xin thông báo mở bán đợt 2 với ưu đãi <b> giảm 15% cho chỉ 60 khách </b> đặt trước.<br>
  Giao dự kiến: Từ Thứ 7 – 22/11/2025.
</div>


<div class="container">

  <!-- ================================== -->
  <!-- ACTIVE 1 -->
  <!-- ================================== -->
  <div class="product-card" data-id="active_xh">
    <img src="https://fun-sport.co/assets/images/gallery/pickleball/active/3.webp">
    <h3>Active – Xanh/Hồng</h3>
    <div class="desc">Carbon Toray – Lõi 5S – Trợ lực tốt – Đầm tay</div>

    <div class="price-old">1.600.000đ</div>
    <div class="price-new">1.360.000đ (đặt trước)</div>
    <div class="save">Tiết kiệm 240.000đ</div>

    <div class="progress-wrap">
      <div class="progress-fill" id="fill_active_xh"></div>
    </div>
    <div class="slot-text" id="text_active_xh">Đã đặt: -- / 20</div>

    <div class="btn-select" onclick="openForm('Active – Xanh/Hồng', 1360000, 'active_xh')">
      Đặt Trước Mẫu Này
    </div>
  </div>

  <!-- ================================== -->
  <!-- ACTIVE 2 -->
  <!-- ================================== -->
  <div class="product-card" data-id="active_xd">
    <img src="https://fun-sport.co/assets/images/gallery/pickleball/active/1.webp">
    <h3>Active – Xanh Dương/Xanh Lá</h3>
    <div class="desc">Carbon Toray – Lõi 5S – Nhám cao – Cầm chắc tay</div>

    <div class="price-old">1.600.000đ</div>
    <div class="price-new">1.360.000đ (đặt trước)</div>
    <div class="save">Tiết kiệm 240.000đ</div>

    <div class="progress-wrap">
      <div class="progress-fill" id="fill_active_xd"></div>
    </div>
    <div class="slot-text" id="text_active_xd">Đã đặt: -- / 20</div>

    <div class="btn-select" onclick="openForm('Active – Xanh Dương/Xanh Lá', 1360000, 'active_xd')">
      Đặt Trước Mẫu Này
    </div>
  </div>

  <!-- ================================== -->
  <!-- FASTBLOCK -->
  <!-- ================================== -->
  <div class="product-card" data-id="fastblock">
    <img src="https://fun-sport.co/assets/images/gallery/pickleball/active/2.webp">
    <h3>Fastblock – Trắng</h3>
    <div class="desc">Lõi Gen4 Plus – Kiểm soát – Thật tay – Nhám bền</div>

    <div class="price-old">1.250.000đ</div>
    <div class="price-new">1.062.000đ (đặt trước)</div>
    <div class="save">Tiết kiệm 188.000đ</div>

    <div class="progress-wrap">
      <div class="progress-fill" id="fill_fastblock"></div>
    </div>
    <div class="slot-text" id="text_fastblock">Đã đặt: -- / 20</div>

    <div class="btn-select" onclick="openForm('Fastblock – Trắng', 1062000, 'fastblock')">
      Đặt Trước Mẫu Này
    </div>
  </div>

</div>

<!-- ============================= -->
<!--           POPUP FORM          -->
<!-- ============================= -->
<div id="formPopup">
  <div class="popup-box">
    <h2>Thông Tin Đặt Trước</h2>
    <p id="chosenProduct"></p>

    <label>Họ và tên</label>
    <input id="fullname">

    <label>Số điện thoại</label>
    <input id="phone">

    <label>Địa chỉ nhận hàng</label>
    <textarea id="address" rows="3"></textarea>

    <button class="submit-btn" onclick="submitForm()">Xác Nhận Đặt Trước</button>
  </div>
</div>

<!-- ============================= -->
<!--         SUCCESS POPUP         -->
<!-- ============================= -->
<div id="successPopup">
  <div class="popup-box">
    <!-- nút X góc phải -->
    <div onclick="closeSuccess()"
         style="position:absolute; top:-14px; right:-14px;
                background:#000000cc; width:32px; height:32px;
                border-radius:50%; display:flex; align-items:center; justify-content:center;
                color:#fff; font-size:18px; cursor:pointer;">
      ✕
    </div>

    <h2 style="margin-top:10px;">Đặt Trước Thành Công!</h2>
    <p style="text-align:center; color:#444; margin-bottom:18px;">
      F-Sport sẽ liên hệ bạn trong thời gian sớm nhất.
    </p>

    <!-- hàng icon điều hướng -->
    <div class="nav-row">

      <!-- Home -->
      <a href="https://fun-sport.co" class="nav-item">
        <img src="https://img.icons8.com/ios-filled/20/000000/home.png" alt="Home" width="22" height="22">
        <span>Home</span>
      </a>

      <!-- Zalo (icon tạm dùng hình tròn Z) -->
      <a href="https://zalo.me/3913722836443497435" target="_blank" class="nav-item">
        <img src="https://img.icons8.com/ios-filled/20/000000/chat.png" alt="Zalo" width="22" height="22">
        <span>Zalo</span>
      </a>

      <!-- Messenger -->
      <a href="https://m.me/funsport1" target="_blank" class="nav-item">
        <img src="https://img.icons8.com/ios-filled/20/000000/facebook-messenger.png" alt="Messenger" width="22" height="22">
        <span>Mess</span>
      </a>

      <!-- Call -->
      <a href="tel:0384735980" class="nav-item">
        <img src="https://img.icons8.com/ios-filled/20/000000/phone.png" alt="Call" width="22" height="22">
        <span>Call</span>
      </a>

    </div>
  </div>
</div>

<script>
/* ==========================================
   SLOT SYSTEM (20 suất mỗi mẫu)
========================================== */
const MAX_SLOT = 20;
const MODELS = ["active_xh", "active_xd", "fastblock"];

function initSlots() {
  MODELS.forEach(id => {
    let count = parseInt(localStorage.getItem("count_" + id)) || randomStart();
    let last = parseInt(localStorage.getItem("last_" + id)) || 0;
    let now = Date.now();

    // Tự tăng nhẹ theo giờ
    if (now - last > randomHours()) {
      if (count < MAX_SLOT - 3) {
        count += Math.floor(Math.random() * 2) + 1;
      }
      localStorage.setItem("count_" + id, count);
      localStorage.setItem("last_" + id, now);
    }

    updateSlotUI(id, count);
  });
}

function randomStart() { return Math.floor(Math.random() * 4) + 2; }
function randomHours() { return (2 + Math.random() * 2) * 60 * 60 * 1000; }

function updateSlotUI(id, count) {
  const fill = document.getElementById("fill_" + id);
  const text = document.getElementById("text_" + id);
  let percent = (count / MAX_SLOT) * 100;

  fill.style.width = percent + "%";
  text.textContent = `Đã đặt: ${count} / ${MAX_SLOT}`;
}

/* ==========================================
   VIEWCONTENT (vừa vào trang)
========================================== */
document.addEventListener("DOMContentLoaded", function () {
  initSlots();

  if (typeof trackBothPixels === "function") {
    trackBothPixels("ViewContent", {
      content_name: "Preorder Active & Fastblock",
      currency: "VND",
      value: 0
    });
  }
});

let selectedModel = "";
let preorderPrice = 0;
let selectedID = "";

/* ==========================================
   OPEN FORM = AddToCart
========================================== */
function openForm(model, price, id) {
  selectedModel = model;
  preorderPrice = price;
  selectedID = id;

  document.getElementById("chosenProduct").innerHTML =
    `<b>${model}</b><br>Giá đặt trước: <span style="color:#e53935">${price.toLocaleString("vi-VN")}đ</span>`;

  document.getElementById("formPopup").style.display = "flex";

  if (typeof trackBothPixels === "function") {
    trackBothPixels("AddToCart", {
      content_name: model,
      currency: "VND",
      value: 0
    });
  }
}

/* ==========================================
   SUBMIT FORM = Purchase
========================================== */
async function submitForm() {
  const data = {
    fullname: fullname.value.trim(),
    phone: phone.value.trim(),
    address: address.value.trim(),
    product: selectedModel
  };

  if (!data.fullname || !data.phone || !data.address) {
    alert("Vui lòng điền đầy đủ thông tin.");
    return;
  }

  // tăng slot
  let current = parseInt(localStorage.getItem("count_" + selectedID)) || 0;
  if (current < MAX_SLOT) {
    current += 1;
    localStorage.setItem("count_" + selectedID, current);
    updateSlotUI(selectedID, current);
  }

  // tracking
  if (typeof trackBothPixels === "function") {
    trackBothPixels("Purchase", {
      content_name: selectedModel,
      currency: "VND",
      value: preorderPrice
    });
  }

  // gửi Make.com
  await fetch("https://hook.eu2.make.com/jq6lnb18kmrs1o5uocqtadxravklnpqq", {
    method: "POST",
    headers: {"Content-Type":"application/json"},
    body: JSON.stringify(data)
  });

  document.getElementById("formPopup").style.display = "none";
  document.getElementById("successPopup").style.display = "flex";
}

function closeSuccess() {
  document.getElementById("successPopup").style.display = "none";
}
</script>

</body>
</html>
