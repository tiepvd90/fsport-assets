<style>
  .review-item {
    margin-top: 16px;
  }

  .review-header {
    font-size: 13px;
    font-weight: 500;
    color: #444;
    margin-bottom: 4px;
  }

  .review-stars {
    color: #FFD700;
    font-size: 14px;
    margin-bottom: 4px;
  }

  .review-text {
    font-size: 14px;
    color: #222;
    line-height: 1.5;
    margin-bottom: 6px;
  }

  .review-images {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    margin-top: 6px;
    box-sizing: border-box;
  }

  .review-image {
    width: calc(25% - 4.5px); /* 4 ảnh mỗi hàng */
    aspect-ratio: 1 / 1;
    object-fit: cover;
    border-radius: 6px;
    box-sizing: border-box;
  }
</style>

<h2 style="font-size: 16px; font-weight: bold; margin-bottom: 12px;">
  Review Sản Phẩm
</h2>

<div id="review1" class="review-item"></div>
<div id="review2" class="review-item"></div>

<script>
  window.loai = "chair";
  window.productPage = "chair001";

  const reviewPool = [
    { name: "Linh N. (Hà Nội)", text: "Mình mua ghế cho bé ngồi học bài, thấy bé ngồi đúng tư thế hơn hẳn, không bị cúi sát vở như trước. Rất đáng tiền!" },
    { name: "Hương T. (HCM)", text: "Là mẹ bỉm hay phải bế con cho ti, mình rất thích ghế này vì tựa lưng êm, đỡ đau vai gáy. Ngồi lâu không khó chịu như ghế nhựa." },
    // ... Giữ nguyên các review khác ...
    { name: "Hậu N. (Biên Hòa)", text: "Rất hài lòng với lớp đệm – êm mà không bị lún. Ghế không ọp ẹp như mấy loại ghế ngồi bệt bình thường. Đúng là ghế cao cấp!" }
  ];

  function getUniqueRandomIndices(count, max) {
    const set = new Set();
    while (set.size < count) {
      set.add(Math.floor(Math.random() * max));
    }
    return Array.from(set);
  }

  function getRandomReviews() {
    const indices = getUniqueRandomIndices(2, reviewPool.length);
    return [reviewPool[indices[0]], reviewPool[indices[1]]];
  }

  function getReviewImages() {
    const indices = getUniqueRandomIndices(8, 8).map(i => i + 1); // CHỈ LẤY TỪ 1–8
    return {
      review1: indices.slice(0, 4),
      review2: indices.slice(4, 8)
    };
  }

  function renderReview(containerId, name, text, imageNums) {
    const loai = window.loai;
    const productPage = window.productPage;
    const container = document.getElementById(containerId);

    const imagesHTML = imageNums.map(n =>
      `<img src="/assets/images/thumb/reviews/${loai}/${productPage}/${n}.webp" alt="Ảnh review ${n}" class="review-image">`
    ).join("");

    container.innerHTML = `
      <div class="review-header">
        <span class="review-name">${name}</span>
      </div>
      <div class="review-stars">★★★★★</div>
      <div class="review-text">${text}</div>
      <div class="review-images">${imagesHTML}</div>
    `;
  }

  function initReviews() {
    try {
      const [r1, r2] = getRandomReviews();
      const { review1, review2 } = getReviewImages();

      console.log("Review chọn:", r1.name, r2.name);
      console.log("Ảnh review1:", review1);
      console.log("Ảnh review2:", review2);

      renderReview("review1", r1.name, r1.text, review1);
      renderReview("review2", r2.name, r2.text, review2);
    } catch (err) {
      console.error("❌ Lỗi khi khởi tạo review:", err);
    }
  }

  initReviews();
</script>

