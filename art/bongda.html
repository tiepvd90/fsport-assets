<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, minimum-scale=1.0,
                 maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />

  <!-- üîπ CSS CHUNG -->
  <link rel="stylesheet" href="/stories/css/stories.css">
  <link rel="stylesheet" href="/css/base.css">
  <link rel="stylesheet" href="/css/art.css">

  <title>B·ªô S∆∞u T·∫≠p Tranh Decor B√≥ng ƒê√° | Fun Sport</title>
  <link rel="icon" type="image/png" href="/favicon.png" />

  <!-- üîπ CHECKOUT & VOUCHER POPUP -->
  <link rel="stylesheet" href="https://friendly-kitten-d760ff.netlify.app/css/checkoutpopup.css" />
  <link rel="stylesheet" href="https://friendly-kitten-d760ff.netlify.app/css/voucherpopup.css" />
  <script>window.productPage = "homepage";</script>
  <script src="https://friendly-kitten-d760ff.netlify.app/js/voucherpopup.js" defer></script>

  <!-- üîπ GOOGLE ANALYTICS -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-RXC205951M"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-RXC205951M');
  </script>
</head>

<body>
  <h1>B·ªò S∆ØU T·∫¨P TRANH DECOR B√ìNG ƒê√Å</h1>
  <div class="collection-container" id="collectionContainer"></div>

  <!-- ‚úÖ CHECKOUT POPUP -->
  <div id="checkoutPopup-placeholder"></div>
  <script>
    fetch("/html/checkoutpopup.html")
      .then(res => res.text())
      .then(html => {
        document.getElementById("checkoutPopup-placeholder").innerHTML = html;
        const script = document.createElement("script");
        script.src = "https://friendly-kitten-d760ff.netlify.app/js/checkoutpopup.js";
        document.body.appendChild(script);
      });
  </script>

  <!-- ‚úÖ GALLERY SCRIPT -->
  <script>
  // üîπ Danh s√°ch file JSON
  const artFiles = ["cauthu","arsenal","barca","manu","chelsea","real"];

  async function loadCollections() {
    const container = document.getElementById("collectionContainer");
    container.innerHTML = "";

    for (const name of artFiles) {
      try {
        const res = await fetch(`/json/art/${name}.json`);
        const data = await res.json();

        // üîç ƒê·ªá quy t√¨m t·∫•t c·∫£ field "image"
        const images = [];
        (function findImages(obj) {
          if (Array.isArray(obj)) {
            obj.forEach(findImages);
          } else if (obj && typeof obj === "object") {
            for (const [key, val] of Object.entries(obj)) {
              if (key === "image" && typeof val === "string") {
                images.push(val);
              } else {
                findImages(val);
              }
            }
          }
        })(data);

        if (!images.length) {
          console.warn(`Kh√¥ng t√¨m th·∫•y ·∫£nh trong ${name}.json`);
          continue;
        }

        // ---- Render block ----
        const block = document.createElement("div");
        block.className = "collection-block";

        const title = document.createElement("div");
        title.className = "collection-title";
        title.textContent = name.toUpperCase();
        block.appendChild(title);

        const grid = document.createElement("div");
        grid.className = "art-grid";

        images.forEach(src => {
          const item = document.createElement("div");
          item.className = "art-item";
          const img = document.createElement("img");
          img.src = src;
          img.alt = name;
          item.appendChild(img);
          item.onclick = () => (window.location.href = `/art/${name}`);
          grid.appendChild(item);
        });

        block.appendChild(grid);

        const moreBtn = document.createElement("a");
        moreBtn.className = "view-more";
        moreBtn.href = `/art/${name}`;
        moreBtn.textContent = `XEM B·ªò ${name.toUpperCase()}`;
        block.appendChild(moreBtn);

        container.appendChild(block);

        const divider = document.createElement("div");
        divider.className = "divider";
        container.appendChild(divider);
      } catch (err) {
        console.error(`‚ùå L·ªói ƒë·ªçc /json/art/${name}.json:`, err);
      }
    }
  }

  loadCollections();
  </script>

  <!-- üîπ BASE SCRIPT -->
  <script src="/js/base.js"></script>
</body>
</html>
